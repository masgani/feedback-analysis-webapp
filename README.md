# AI フィードバック分析 Web アプリケーション

## 概要
本リポジトリは、アンケート形式のフィードバックCSVを入力として受け取り、
日本語テキストの感情分析（ポジ／ニュートラル／ネガ）を自動で実行し、
結果を可視化・ダウンロード可能なWebアプリケーションです。

## 特徴
- Streamlit を用いたシンプルな Web UI
- 日本語 BERT による感情推論
- 部署情報がある場合のみ適用される追加ルール
- FastAPI による推論API（UIと分離）
- Docker による再現可能な実行環境

## 主な機能
- CSV ファイルアップロード
- 日本語テキスト感情分析（ポジ / ニュートラル / ネガ）
- 部署別件数、スコア分布、感情分布の可視化
- ワードクラウド生成（日本語対応）
- 分析結果CSVのダウンロード
- Docker / Docker Compose による簡単起動


## アーキテクチャ概要
本アプリケーションは、以下の構成で実装されています。

- Frontend: Streamlit  
  - CSVアップロード
  - 可視化・ダウンロード
- Backend: FastAPI  
  - 感情分析推論API（/predict）
- Core:
  - 前処理・推論・ルール・集計ロジック

UIと推論ロジックを分離することで、
将来的なUI変更や他システムからのAPI利用を容易にしています。


## 感情分析アルゴリズム概要

## 入力 CSV 仕様

### 必須カラム
- answer_text  
  感情分析対象となる日本語テキスト

### 任意カラム
- department  
  部署名。存在する場合のみ、部署別ルールが適用されます。

- satisfaction_score  
  満足度スコア。可視化のみに使用されます。


### 使用モデル
- koheiduck/bert-japanese-finetuned-sentiment
- 日本語 BERT による 3 クラス分類

## 任意カラムが存在しない場合の挙動
- department が存在しない場合  
  → 部署別ルールは無効化されます。
- satisfaction_score が存在しない場合  
  → スコア分布グラフは表示されません。


### 推論フロー
1. テキストが空の場合 → ニュートラル
2. モデル推論（softmax）
3. 信頼度が閾値未満の場合 → ニュートラル
4. グローバル中立マーカー判定
5. 部署別ルール（該当時）
6. グローバルポジティブマーカー判定
